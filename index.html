<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Game Calculator</title>
    <style>
      :root {
        --color-background: #121212;
        --color-surface: #1e1e1e;
        --color-primary: #0d6efd;
        --color-primary-light: #3b82f6;
        --color-on-primary: #ffffff;
        --color-text: #e0e0e0;
        --color-text-secondary: #a0a0a0;
        --color-border: #333333;
        --shadow-color: rgba(0, 111, 255, 0.2);
        --shadow-elevation: 0 4px 16px var(--shadow-color);
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        background-color: var(--color-background);
        color: var(--color-text);
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        padding: 20px;
      }

      .main-container {
        width: 100%;
        max-width: 550px; /* Slightly wider */
        background-color: var(--color-surface);
        border-radius: 20px; /* Softer edges */
        box-shadow: var(--shadow-elevation);
        overflow: hidden;
      }

      .tab-nav {
        display: flex;
        background-color: #2a2a2a; /* Darker background for nav */
      }

      .tab-button {
        flex: 1;
        padding: 18px 10px; /* Increased padding */
        background-color: transparent;
        border: none;
        color: var(--color-text-secondary);
        font-size: 15px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
        border-bottom: 3px solid transparent;
      }

      .tab-button:hover {
        color: var(--color-on-primary);
        background-color: rgba(255,255,255,0.08);
      }

      .tab-button.active {
        color: var(--color-primary-light);
        border-bottom-color: var(--color-primary-light);
        background-color: #333333; /* Highlight active tab */
      }

      .tab-content {
        display: none;
        padding: 30px; /* Increased padding */
      }

      .tab-content.active {
        display: block;
      }
      
      .tab-content h2 {
          text-align: center;
          margin-bottom: 30px;
          color: var(--color-primary-light);
          font-size: 1.8em;
      }

      /* Calculator Styles */
      .input-group {
        margin-bottom: 25px;
      }

      .input-group label {
        display: block;
        font-size: 15px;
        font-weight: 500;
        margin-bottom: 10px;
        color: var(--color-text); /* Brighter label */
      }

      .input-row {
        display: flex;
        gap: 15px;
        align-items: center;
      }

      input[type="number"], select {
        padding: 14px; /* Larger input */
        border-radius: 10px;
        border: 1px solid var(--color-border);
        font-size: 17px;
        background-color: #0d0d0d; /* Slightly darker input background */
        color: var(--color-text);
        transition: border-color 0.2s ease, box-shadow 0.2s ease;
        appearance: none; /* Remove default styling */
        -webkit-appearance: none;
        -moz-appearance: none;
      }

      input[type="number"] {
        width: 100%;
      }

      input[type="number"]:focus, select:focus {
        outline: none;
        border-color: var(--color-primary);
        box-shadow: 0 0 0 4px var(--shadow-color);
      }

      select {
        width: 140px; /* Slightly wider select */
        flex-shrink: 0;
        cursor: pointer;
      }

      .mode-toggle {
        display: flex; /* Changed to flex for better control */
        gap: 15px;
        margin-bottom: 30px;
      }

      .mode-btn {
        flex: 1;
        padding: 14px 10px;
        cursor: pointer;
        background-color: var(--color-background);
        color: var(--color-text-secondary);
        border: 2px solid var(--color-border); /* Thicker border */
        border-radius: 10px;
        font-size: 15px;
        font-weight: 500;
        transition: all 0.2s ease;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }

      .mode-btn:hover:not(.active) {
        border-color: var(--color-primary-light);
        color: var(--color-primary-light);
        background-color: rgba(255,255,255,0.05);
      }

      .mode-btn.active {
        background-color: var(--color-primary);
        color: var(--color-on-primary);
        border-color: var(--color-primary);
        box-shadow: 0 4px 8px var(--shadow-color);
      }

      .result-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); /* Responsive grid */
        gap: 20px; /* Increased gap */
        text-align: center;
      }

      .result-box {
        background-color: #272727; /* Distinct background for results */
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
      }

      .result-box .value {
        font-size: 28px; /* Larger value */
        font-weight: 700;
        color: var(--color-primary-light);
        margin-bottom: 8px;
        word-break: break-all;
      }

      .result-box .label {
        font-size: 14px;
        color: var(--color-text-secondary);
        font-weight: 400;
      }

      .small { 
        font-size: 13px; 
        opacity: 0.9; 
        margin-top: 5px;
      }

    </style>
</head>
<body>
    <div class="main-container">
        <nav class="tab-nav">
            <button class="tab-button" data-tab="rank">Rank</button>
            <button class="tab-button active" data-tab="mastery">Mastery</button>
            <button class="tab-button" data-tab="damage">Damage</button>
            <button class="tab-button" data-tab="gacha">Gacha</button>
        </nav>

        <div id="rank-content" class="tab-content">
            <h2>Rank Calculator</h2>
            <p style="text-align:center; color: var(--color-text-secondary);">This feature is coming soon.</p>
        </div>

        <div id="mastery-content" class="tab-content active">
            <h2>Mastery Calculator</h2>
            <div class="input-group">
                <label for="dmgInput">Mastery per Click (Base Value)</label>
                <div class="input-row">
                    <input id="dmgInput" placeholder="Enter value..." type="number" step="0.01" value="10" />
                    <select id="suffixSelect">
                      <option value="none">None</option>
                      <option value="K">K (10³)</option>
                      <option value="M">M (10⁶)</option>
                      <option value="B">B (10⁹)</option>
                      <option value="T">T (10¹²)</option>
                      <option value="Qa">Qa (10¹⁵)</option>
                      <option value="Qi">Qi (10¹⁸)</option>
                      <option value="Sx">Sx (10²¹)</option>
                      <option value="Sp">Sp (10²⁴)</option>
                      <option value="Oc">Oc (10²⁷)</option>
                      <option value="No">No (10³⁰)</option>
                      <option value="Dc">Dc (10³³)</option>
                      <option value="Ud">Ud (10³⁶)</option>
                      <option value="Dd">Dd (10³⁹)</option>
                      <option value="Td">Td (10⁴²)</option>
                      <option value="Qad">Qad (10⁴⁵)</option>
                      <option value="Qid">Qid (10⁴⁸)</option>
                      <option value="Sxd">Sxd (10⁵¹)</option>
                      <option value="Spd">Spd (10⁵⁴)</option>
                      <option value="Ocd">Ocd (10⁵⁷)</option>
                      <option value="Nod">Nod (10⁶⁰)</option>
                      <option value="Vg">Vg (10⁶³)</option>
                      <option value="Uvg">Uvg (10⁶⁶)</option>
                      <option value="Dvg">Dvg (10⁶⁹)</option>
                      <option value="Tvg">Tvg (10⁷²)</option>
                    </select>
                </div>
            </div>

            <div class="mode-toggle">
                <button id="fastBtn" class="mode-btn active">
                    Fast Click
                    <span class="small">5.8 clicks/sec</span>
                </button>
                <button id="slowBtn" class="mode-btn">
                    Slow Click
                    <span class="small">4.5 clicks/sec</span>
                </button>
            </div>

            <div class="result-grid">
                <div class="result-box">
                    <div id="resultBox" class="value">0</div>
                    <div class="label">Mastery per Second</div>
                </div>
                <div class="result-box">
                    <div id="perHourResult" class="value">0</div>
                    <div class="label">Mastery per Hour</div>
                </div>
                <div class="result-box">
                    <div id="perDayResult" class="value">0</div>
                    <div class="label">Mastery per Day</div>
                </div>
            </div>
        </div>

        <div id="damage-content" class="tab-content">
            <h2>Damage Calculator</h2>
            <p style="text-align:center; color: var(--color-text-secondary);">This feature is coming soon.</p>
        </div>

        <div id="gacha-content" class="tab-content">
            <h2>Gacha Calculator</h2>
            <p style="text-align:center; color: var(--color-text-secondary);">This feature is coming soon.</p>
        </div>
    </div>

    <script>
        // --- Tab Navigation ---
        const tabs = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // Deactivate all tabs and content
                tabs.forEach(item => item.classList.remove('active'));
                tabContents.forEach(content => content.classList.remove('active'));

                // Activate clicked tab and its content
                tab.classList.add('active');
                const contentId = tab.dataset.tab + '-content';
                const contentElement = document.getElementById(contentId);
                if (contentElement) {
                    contentElement.classList.add('active');
                }
            });
        });

        // --- Calculator Logic ---
        const dmgInput = document.getElementById("dmgInput");
        const suffixSelect = document.getElementById("suffixSelect");
        const resultBox = document.getElementById("resultBox");
        const fastBtn = document.getElementById("fastBtn");
        const slowBtn = document.getElementById("slowBtn");
        const perHourResult = document.getElementById("perHourResult");
        // FIX: The original code had a typo here: document.getElementById was missing 'get'
        const perDayResult = document.getElementById("perDayResult"); 

        let cps = 5.8;

        fastBtn.onclick = () => { 
            cps = 5.8; 
            fastBtn.classList.add("active"); 
            slowBtn.classList.remove("active"); 
            update(); 
        };
        slowBtn.onclick = () => { 
            cps = 4.5; 
            slowBtn.classList.add("active"); 
            fastBtn.classList.remove("active"); 
            update(); 
        };

        dmgInput.oninput = update;
        suffixSelect.onchange = update;

        const suffixes = { "none": 0, "K": 1, "M": 2, "B": 3, "T": 4, "Qa": 5, "Qi": 6, "Sx": 7, "Sp": 8, "Oc": 9, "No": 10, "Dc": 11, "Ud": 12, "Dd": 13, "Td": 14, "Qad": 15, "Qid": 16, "Sxd": 17, "Spd": 18, "Ocd": 19, "Nod": 20, "Vg": 21, "Uvg": 22, "Dvg": 23, "Tvg": 24 };
        const suffixList = Object.keys(suffixes).slice(1);
        const suffixUnits = ["", "K", "M", "B", "T", "Qa", "Qi", "Sx", "Sp", "Oc", "No", "Dc", "Ud", "Dd", "Td", "Qad", "Qid", "Sxd", "Spd", "Ocd", "Nod", "Vg", "Uvg", "Dvg", "Tvg"];


        function formatNumber(num) {
            // Use BigInt for calculation, so the input should be BigInt
            if (num < 1000n) {
                return num.toString();
            }

            let numDiv = num;
            let suffixIndex = 0;

            // Iterate until the number is less than 1000 (after division)
            while (numDiv >= 1000n && suffixIndex < suffixList.length) {
                numDiv /= 1000n;
                suffixIndex++;
            }
            
            // Calculate remainder for decimals
            // To get two decimal places, we need to multiply the original BigInt by 100 before the first division
            // and keep track of the divisor

            // Original number scaled by 100
            const scaledNum = num * 100n;
            const divisor = 100n * (1000n ** BigInt(suffixIndex));
            
            // The number of units for the main value (e.g., 1.23M)
            const mainValue = scaledNum / divisor; 
            
            // The fractional part
            const fractionalPart = scaledNum % divisor;
            
            // Re-combine and format
            const formattedNum = Number(mainValue) / 100;

            // Handle case where we ran out of suffixes
            if (suffixIndex >= suffixUnits.length) {
                return num.toString();
            }

            return formattedNum.toFixed(2) + suffixUnits[suffixIndex];
        }


        function parseInput() {
            const rawValue = parseFloat(dmgInput.value);
            if (isNaN(rawValue) || rawValue <= 0) return 0n;

            const selectedSuffix = suffixSelect.value;
            const exponent = suffixes[selectedSuffix];
            if (exponent === undefined) return 0n;

            // Calculate the multiplier (1000^exponent)
            const multiplier = 10n ** BigInt(exponent * 3);
            
            // Convert the float input to BigInt by multiplying by the multiplier and rounding to nearest whole number
            // We use Math.round for better precision before converting to BigInt
            // The division by 100n later in update() accounts for rounding the input to 2 decimal places if necessary, 
            // but for simplicity and to match the original logic (which rounded *before* multiplying), 
            // we'll treat the float as is for now and let the BigInt logic handle the final formatting.
            
            // Simplified approach: Multiply the raw float by the multiplier, then convert to BigInt
            // Since the final display uses 2 decimal places, let's multiply by 100 before converting to BigInt
            // to retain precision equivalent to two decimal places (i.e., treating the value as 'cents' or 'hundredths')
            // BigInt expects whole numbers.

            // The 'hundredths' value (Base Dmg * Multiplier * 100)
            return BigInt(Math.round(rawValue * 100)) * multiplier;
        }

        function update() {
            // baseDmg is the total mastery per click, scaled by 100 (to allow for two decimal places of precision)
            const baseDmgScaled = parseInput(); 
            
            if (baseDmgScaled === 0n) {
                resultBox.innerHTML = "0";
                perHourResult.innerHTML = "0";
                perDayResult.innerHTML = "0";
                return;
            }

            // DPS Calculation: (Base Dmg * CPS)
            // We need to multiply baseDmgScaled by CPS and then divide by 100
            // Since CPS is a float, we multiply by a scaled BigInt version of CPS (e.g., 5.8 * 100 = 580)
            const cpsScaled = BigInt(Math.round(cps * 100)); // 580n or 450n
            
            // dpsScaled = (baseDmgScaled * cpsScaled) / 100n 
            // This result is still scaled by 100
            const dpsScaled = (baseDmgScaled * cpsScaled) / 100n; 

            // Result per Second (RPS) - final value (un-scaled)
            const rpsValue = dpsScaled / 100n;

            // Display DPS. We only format large numbers.
            resultBox.innerHTML = formatNumber(rpsValue);


            // Result per Hour (RPH) - (RPS * 3600)
            // dpsScaled is scaled by 100, so 3600 * 100 = 360000n
            const rphScaled = dpsScaled * 3600n / 100n; 
            const rphValue = dpsScaled * 36n; // 3600 * dps / 100
            perHourResult.innerHTML = formatNumber(rphValue);

            // Result per Day (RPD) - (RPS * 86400)
            // dpsScaled is scaled by 100, so 86400 * 100 = 8640000n
            const rpdScaled = dpsScaled * 86400n / 100n;
            const rpdValue = dpsScaled * 864n; // 86400 * dps / 100
            perDayResult.innerHTML = formatNumber(rpdValue);
        }

        // Initial call to set the state
        update();
    </script>
</body>
</html>
